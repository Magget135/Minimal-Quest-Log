/*! For license information please see main.1525620a.js.LICENSE.txt */
(()=>{"use strict";var e={175:(e,t)=>{const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,a=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,l=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,i=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function s(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function u(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function c(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},4:(e,t,n)=>{var r=n(853),a=n(43),l=n(950);function o(e){var t="https://ace18cbc-8eb0-42fb-ac3e-6c117ce871d5.preview.emergentagent.com","/api"),Qr=["Common","Rare","Epic","Legendary"],Kr=["Pending","In Progress","Completed","Incomplete"];function Yr(){return(0,a.useMemo)((()=>Wr.create({baseURL:Vr})),[])}function Xr(){return(0,$r.jsx)("div",{className:"navbar",children:(0,$r.jsxs)("div",{className:"container row",style:{justifyContent:"space-between"},children:[(0,$r.jsx)("div",{className:"nav-brand",children:"Quest Tracker"}),(0,$r.jsxs)("div",{className:"nav-items",children:[(0,$r.jsx)(mt,{to:"/",className:e=>{let{isActive:t}=e;return"nav-item ".concat(t?"nav-item-active":"nav-item-inactive")},children:"Active"}),(0,$r.jsx)(mt,{to:"/completed",className:e=>{let{isActive:t}=e;return"nav-item ".concat(t?"nav-item-active":"nav-item-inactive")},children:"Completed"}),(0,$r.jsx)(mt,{to:"/rewards",className:e=>{let{isActive:t}=e;return"nav-item ".concat(t?"nav-item-active":"nav-item-inactive")},children:"Rewards"}),(0,$r.jsx)(mt,{to:"/recurring",className:e=>{let{isActive:t}=e;return"nav-item ".concat(t?"nav-item-active":"nav-item-inactive")},children:"Recurring"}),(0,$r.jsx)(mt,{to:"/rules",className:e=>{let{isActive:t}=e;return"nav-item ".concat(t?"nav-item-active":"nav-item-inactive")},children:"Rules"})]})]})})}function Jr(e){let{selectedDate:t,onSelect:n}=e;const[r,l]=(0,a.useState)(new Date(t)),o=new Date(r.getFullYear(),r.getMonth(),1),i=(new Date(r.getFullYear(),r.getMonth()+1,0),ta(o)),s=Array.from({length:42},((e,t)=>na(i,t))),u=r.toLocaleDateString(void 0,{month:"long",year:"numeric"}),c=ea(new Date);return(0,$r.jsxs)("div",{className:"mini-month",children:[(0,$r.jsxs)("div",{className:"mini-header",children:[(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>l(new Date(r.getFullYear(),r.getMonth()-1,1)),children:"\u25c0"}),(0,$r.jsx)("div",{children:u}),(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>l(new Date(r.getFullYear(),r.getMonth()+1,1)),children:"\u25b6"})]}),(0,$r.jsxs)("div",{className:"mini-grid",children:[["MON","TUE","WED","THU","FRI","SAT","SUN"].map((e=>(0,$r.jsx)("div",{className:"mini-dow",children:e},e))),s.map(((e,a)=>{const l=e.getMonth()!==r.getMonth(),o=ea(e),i=ea(t)===o;return(0,$r.jsxs)("div",{className:"mini-cell ".concat(l?"other":""," ").concat(i?"selected":""),onClick:()=>n(e),children:[e.getDate(),o===c?(0,$r.jsx)("span",{className:"dot-today"}):null]},a)}))]})]})}function Gr(e){var t;let{summary:n}=e;return(0,$r.jsxs)("div",{className:"badge",children:[(0,$r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,$r.jsx)("path",{d:"M12 2l3 7h7l-5.5 4 2.5 7-7-4.5L5 20l2.5-7L2 9h7z"})}),(0,$r.jsxs)("span",{className:"small",children:["XP: ",null!==(t=null===n||void 0===n?void 0:n.balance)&&void 0!==t?t:0]})]})}function Zr(){const e=Yr(),[t,n]=(0,a.useState)({total_earned:0,total_spent:0,balance:0}),r=async()=>{const{data:t}=await e.get("/xp/summary");n(t)};return(0,a.useEffect)((()=>{r()}),[]),{summary:t,refresh:r}}const ea=e=>"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")),ta=e=>{const t=e.getDay(),n=(0===t?-6:1)-t,r=new Date(e);return r.setDate(e.getDate()+n),new Date(r.getFullYear(),r.getMonth(),r.getDate())},na=(e,t)=>{const n=new Date(e);return n.setDate(e.getDate()+t),n};function ra(e){let{tasks:t,view:n,anchorDate:r,onPrev:a,onNext:l,onToday:o,onViewChange:i,onOpenTask:s}=e,u=[];const c=r.toLocaleDateString(void 0,{month:"long",year:"numeric"});if("week"===n){const e=ta(r);u=Array.from({length:7},((t,n)=>na(e,n)))}else if("month"===n){const e=function(e){const t=new Date(e.getFullYear(),e.getMonth(),1);return ta(t)}(r);u=Array.from({length:42},((t,n)=>na(e,n)))}else u=[new Date(r.getFullYear(),r.getMonth(),r.getDate())];return(0,$r.jsxs)("div",{className:"calendar",children:[(0,$r.jsxs)("div",{className:"calendar-header",children:[(0,$r.jsx)("div",{className:"header-left",children:(0,$r.jsx)("div",{className:"header-title",children:c})}),(0,$r.jsxs)("div",{className:"header-right",children:[(0,$r.jsxs)("div",{className:"calendar-controls",children:[(0,$r.jsx)("button",{className:"btn secondary",onClick:a,children:"Prev"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:o,children:"Today"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:l,children:"Next"})]}),(0,$r.jsxs)("div",{className:"calendar-controls",children:[(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>i("day"),children:"Day"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>i("week"),children:"Week"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>i("month"),children:"Month"})]})]})]}),"day"!==n&&(0,$r.jsx)("div",{className:"month-headers",children:["MON","TUE","WED","THU","FRI","SAT","SUN"].map(((e,t)=>(0,$r.jsx)("div",{className:"month-head-cell",children:e},t)))}),(0,$r.jsx)("div",{className:"calendar-grid ".concat(n),children:u.map(((e,n)=>{const r=ea(e),a=t.filter((e=>e.due_date===r));return(0,$r.jsxs)("div",{className:"calendar-cell",children:[(0,$r.jsx)("div",{className:"calendar-day-number",children:e.getDate()}),(0,$r.jsx)("div",{className:"calendar-tasks",children:a.map((e=>(0,$r.jsx)("div",{className:"task-chip",title:e.quest_name,onClick:()=>s(e),children:e.quest_name},e.id)))})]},n)}))})]})}function aa(e){let{tasks:t,view:n,anchorDate:r,onPrev:a,onNext:l,onToday:o,onViewChange:i,onOpenTask:s}=e;const u="week"===n,c=u?ta(r):new Date(r.getFullYear(),r.getMonth(),r.getDate()),d=u?Array.from({length:7},((e,t)=>na(c,t))):[c],f=(new Date,Object.create(null));d.forEach((e=>{f[ea(e)]={timed:[],allDay:[]}})),t.forEach((e=>{f[e.due_date]&&(e.due_time?f[e.due_date].timed.push(e):f[e.due_date].allDay.push(e))})),Object.values(f).forEach((e=>{e.timed.sort(((e,t)=>(e.due_time||"00:00").localeCompare(t.due_time||"00:00")))}));const p=Array.from({length:24},((e,t)=>t)),h=e=>e.toLocaleDateString(void 0,{weekday:"short"}).toUpperCase(),m=e=>e.getDate(),y=r.toLocaleDateString(void 0,{month:"long",year:"numeric"});return(0,$r.jsxs)("div",{className:"time-calendar",children:[(0,$r.jsxs)("div",{className:"time-header",children:[(0,$r.jsx)("div",{className:"header-left",children:(0,$r.jsx)("div",{className:"header-title",children:y})}),(0,$r.jsxs)("div",{className:"header-right",children:[(0,$r.jsxs)("div",{className:"calendar-controls",children:[(0,$r.jsx)("button",{className:"btn secondary",onClick:a,children:"Prev"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:o,children:"Today"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:l,children:"Next"})]}),(0,$r.jsxs)("div",{className:"calendar-controls",children:[(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>i("day"),children:"Day"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>i("week"),children:"Week"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>i("month"),children:"Month"})]})]})]}),(0,$r.jsxs)("div",{className:"time-scroll",children:[(0,$r.jsxs)("div",{className:"day-headers ".concat(u?"week":"day"),children:[(0,$r.jsx)("div",{className:"day-head-cell"}),d.map((e=>(0,$r.jsx)("div",{className:"day-head-cell",children:(0,$r.jsxs)("div",{className:"day-head-inner",children:[(0,$r.jsx)("div",{className:"dow",children:h(e)}),(0,$r.jsx)("div",{className:"dom",children:m(e)})]})},ea(e))))]}),(0,$r.jsxs)("div",{className:"all-day ".concat(u?"":"day"),children:[(0,$r.jsx)("div",{className:"label",children:"All-day"}),d.map((e=>(0,$r.jsx)("div",{className:"col",children:(0,$r.jsx)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:f[ea(e)].allDay.map((e=>(0,$r.jsx)("div",{className:"task-chip",onClick:()=>s(e),children:e.quest_name},e.id)))})},ea(e))))]}),(0,$r.jsxs)("div",{className:"time-grid ".concat(u?"week":"day"),children:[(0,$r.jsx)("div",{className:"time-labels",children:p.map((e=>(0,$r.jsx)("div",{className:"time-hour",children:0===e?"12 AM":e<12?"".concat(e," AM"):12===e?"12 PM":"".concat(e-12," PM")},e)))}),d.map((e=>(0,$r.jsx)(la,{day:e,items:f[ea(e)].timed,onOpenTask:s},ea(e))))]})]})]})}function la(e){let{day:t,items:n,onOpenTask:r}=e;return(0,$r.jsxs)("div",{className:"time-col",children:[Array.from({length:24},((e,t)=>(0,$r.jsx)("div",{className:"time-hour-line",style:{top:48*t}},t))),n.map((e=>{const[t,n]=(e.due_time||"00:00").split(":").map(Number),a=.8*(60*t+n),l=Math.max(22,30);return(0,$r.jsxs)("div",{className:"task-block",style:{top:a,height:l},title:e.quest_name,onClick:()=>r(e),children:[e.quest_name," ",e.due_time?"(".concat(e.due_time,")"):""]},e.id)})),(()=>{const e=ea(new Date);if(ea(t)!==e)return null;const n=new Date,r=.8*(60*n.getHours()+n.getMinutes());return(0,$r.jsx)("div",{className:"time-now-line",style:{top:r},children:(0,$r.jsx)("div",{className:"time-now-dot"})})})()]})}function oa(e){let{tasks:t,view:n,anchorDate:r,onPrev:a,onNext:l,onToday:o,onViewChange:i,onOpenTask:s}=e;return"month"===n?(0,$r.jsx)(ra,{tasks:t,view:n,anchorDate:r,onPrev:a,onNext:l,onToday:o,onViewChange:i,onOpenTask:s}):(0,$r.jsx)(aa,{tasks:t,view:n,anchorDate:r,onPrev:a,onNext:l,onToday:o,onViewChange:i,onOpenTask:s})}function ia(e){let{open:t,task:n,onClose:r,onSave:l,onDelete:o}=e;const[i,s]=(0,a.useState)((null===n||void 0===n?void 0:n.quest_name)||""),[u,d]=(0,a.useState)((null===n||void 0===n?void 0:n.due_date)||""),[f,p]=(0,a.useState)((null===n||void 0===n?void 0:n.due_time)||"");return(0,a.useEffect)((()=>{s((null===n||void 0===n?void 0:n.quest_name)||""),d((null===n||void 0===n?void 0:n.due_date)||""),p((null===n||void 0===n?void 0:n.due_time)||"")}),[n]),t?(0,$r.jsx)("div",{className:"modal-backdrop",onClick:r,children:(0,$r.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Edit Task"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:r,children:"Close"})]}),(0,$r.jsxs)("div",{className:"row",style:{marginBottom:8},children:[(0,$r.jsx)("input",{className:"input",placeholder:"Task name",value:i,onChange:e=>s(e.target.value)}),(0,$r.jsx)("input",{className:"input",type:"date",value:u,onChange:e=>d(e.target.value)}),(0,$r.jsx)("input",{className:"input",type:"time",value:f,onChange:e=>p(e.target.value)})]}),(0,$r.jsxs)("div",{className:"modal-actions",children:[(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>o(n),children:"Delete"}),(0,$r.jsx)("button",{className:"btn",onClick:()=>l(c(c({},n),{},{quest_name:i,due_date:u,due_time:f||null})),children:"Save"})]})]})}):null}function sa(e){let{open:t,baseDate:n,onClose:r,onSave:l}=e;const o=n||new Date,[i,s]=(0,a.useState)("Daily"),[u,c]=(0,a.useState)(1),[d,f]=(0,a.useState)("date"),[p,h]=(0,a.useState)(1),[m,y]=(0,a.useState)(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][o.getDay()]),[g,v]=(0,a.useState)(o.getDate()),[b,w]=(0,a.useState)("never"),[k,S]=(0,a.useState)(""),[x,E]=(0,a.useState)(0);return t?(0,$r.jsx)("div",{className:"modal-backdrop",onClick:r,children:(0,$r.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Custom Repeat"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:r,children:"Close"})]}),(0,$r.jsxs)("div",{className:"row",style:{flexWrap:"wrap",marginBottom:8},children:[(0,$r.jsx)("select",{value:i,onChange:e=>s(e.target.value),children:["Daily","Weekly","Weekdays","Monthly","Annual"].map((e=>(0,$r.jsx)("option",{children:e},e)))}),(0,$r.jsx)("input",{className:"input",type:"number",min:1,value:u,onChange:e=>c(Number(e.target.value||1))}),(0,$r.jsxs)("span",{className:"small",children:["Every N ",i.toLowerCase()]})]}),"Weekly"===i&&(0,$r.jsxs)("div",{className:"row",style:{marginBottom:8},children:[(0,$r.jsx)("span",{className:"small",children:"Days (Mon, Wed):"}),(0,$r.jsx)("input",{className:"input",placeholder:"Mon, Wed",id:"weekly-days-input"}),(0,$r.jsx)("span",{className:"small",children:"You can edit later in Recurring"})]}),"Monthly"===i&&(0,$r.jsxs)("div",{className:"row",style:{marginBottom:8,flexWrap:"wrap"},children:[(0,$r.jsxs)("select",{value:d,onChange:e=>f(e.target.value),children:[(0,$r.jsxs)("option",{value:"date",children:["On day ",g]}),(0,$r.jsx)("option",{value:"weekday",children:"On the nth weekday"})]}),"date"===d?(0,$r.jsx)("input",{className:"input",type:"number",min:1,max:31,value:g,onChange:e=>v(Number(e.target.value||1))}):(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("select",{value:p,onChange:e=>h(Number(e.target.value)),children:[1,2,3,4,5,-1].map((e=>(0,$r.jsx)("option",{value:e,children:-1===e?"Last":"".concat(e,"th")},e)))}),(0,$r.jsx)("select",{value:m,onChange:e=>y(e.target.value),children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((e=>(0,$r.jsx)("option",{children:e},e)))})]})]}),(0,$r.jsxs)("div",{className:"row",style:{marginBottom:8,flexWrap:"wrap"},children:[(0,$r.jsxs)("select",{value:b,onChange:e=>w(e.target.value),children:[(0,$r.jsx)("option",{value:"never",children:"Ends: Never"}),(0,$r.jsx)("option",{value:"on_date",children:"Ends: On date"}),(0,$r.jsx)("option",{value:"after",children:"Ends: After N"})]}),"on_date"===b&&(0,$r.jsx)("input",{className:"input",type:"date",value:k,onChange:e=>S(e.target.value)}),"after"===b&&(0,$r.jsx)("input",{className:"input",type:"number",min:1,value:x,onChange:e=>E(Number(e.target.value||0))})]}),(0,$r.jsx)("div",{className:"modal-actions",children:(0,$r.jsx)("button",{className:"btn",onClick:()=>{var e;l({frequency:i,interval:u,monthly_mode:"Monthly"===i?d:void 0,monthly_on_date:"Monthly"===i&&"date"===d?g:void 0,monthly_week_index:"Monthly"===i&&"weekday"===d?p:void 0,monthly_weekday:"Monthly"===i&&"weekday"===d?m:void 0,ends:b,until_date:"on_date"===b&&k?k:void 0,count:"after"===b&&x?x:void 0,days:"Weekly"===i?null===(e=document.getElementById("weekly-days-input"))||void 0===e?void 0:e.value:void 0}),r()},children:"Save"})})]})}):null}function ua(e){let{hideExtras:t=!1}=e;const n=Yr(),{summary:r,refresh:l}=Zr(),[o,i]=(0,a.useState)([]),[s,u]=(0,a.useState)("week"),[d,f]=(0,a.useState)(new Date),[p,h]=(0,a.useState)({quest_name:"",quest_rank:"Common",due_date:"",due_time:"",status:"Pending"}),[m,y]=(0,a.useState)("none"),g=async()=>{const e=[...(await n.get("/quests/active")).data].sort(((e,t)=>{const n=new Date(e.due_date+"T00:00:00").getTime(),r=new Date(t.due_date+"T00:00:00").getTime();if(n!==r)return n-r;const a=e.due_time||"",l=t.due_time||"";return a.localeCompare(l)}));i(e)};(0,a.useEffect)((()=>{g()}),[]);const v=async e=>{await n.post("/quests/active/".concat(e,"/complete")),await Promise.all([g(),l()])},b=async(e,t)=>{await n.patch("/quests/active/".concat(e),t),await g()},w=e=>{if(!e)return"";const t=new Date,n=new Date(e+"T00:00:00"),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.getTime()<r.getTime()?"red":n.getTime()===r.getTime()?"blue":"green"},[k,S]=(0,a.useState)(null),x=e=>S(e),E=()=>S(null),[C,N]=(0,a.useState)(!1);return(0,$r.jsxs)("div",{className:"app-shell",children:[(0,$r.jsxs)("div",{className:"sidebar",children:[(0,$r.jsx)(Gr,{summary:r}),(0,$r.jsx)("div",{style:{height:12}}),(0,$r.jsx)(Jr,{selectedDate:d,onSelect:e=>{f(e),u("day")}}),(0,$r.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,$r.jsx)("div",{className:"kicker",style:{marginBottom:8},children:"Quick Add"}),(0,$r.jsxs)("div",{className:"row",style:{flexWrap:"wrap"},children:[(0,$r.jsx)("input",{className:"input",placeholder:"Quest Name",value:p.quest_name,onChange:e=>h(c(c({},p),{},{quest_name:e.target.value}))}),(0,$r.jsx)("select",{value:p.quest_rank,onChange:e=>h(c(c({},p),{},{quest_rank:e.target.value})),children:Qr.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))}),(0,$r.jsx)("input",{type:"date",className:"input",value:p.due_date,onChange:e=>h(c(c({},p),{},{due_date:e.target.value}))}),(0,$r.jsx)("input",{type:"time",className:"input",value:p.due_time,onChange:e=>h(c(c({},p),{},{due_time:e.target.value}))}),(0,$r.jsxs)("select",{value:m,onChange:e=>{const t=e.target.value;y(t),"custom"===t&&N(!0)},children:[(0,$r.jsx)("option",{value:"none",children:"Does not repeat"}),(0,$r.jsx)("option",{value:"daily",children:"Daily"}),(0,$r.jsx)("option",{value:"weekly_on",children:"Weekly on weekday"}),(0,$r.jsx)("option",{value:"weekdays",children:"Every weekday"}),(0,$r.jsx)("option",{value:"monthly_on_date",children:"Monthly on date"}),(0,$r.jsx)("option",{value:"annual",children:"Annually"}),(0,$r.jsx)("option",{value:"custom",children:"Custom\u2026"})]}),(0,$r.jsx)("button",{className:"btn",onClick:async e=>{if(e.preventDefault(),p.quest_name&&p.due_date){await n.post("/quests/active",c(c({},p),{},{due_time:p.due_time||null}));try{const e=new Date(p.due_date+"T00:00:00");let t=null;if("daily"===m)t={task_name:p.quest_name,quest_rank:p.quest_rank,frequency:"Daily",status:p.status};else if("weekly_on"===m){const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()];t={task_name:p.quest_name,quest_rank:p.quest_rank,frequency:"Weekly",days:n,status:p.status}}else"weekdays"===m?t={task_name:p.quest_name,quest_rank:p.quest_rank,frequency:"Weekdays",status:p.status}:"monthly_on_date"===m?t={task_name:p.quest_name,quest_rank:p.quest_rank,frequency:"Monthly",monthly_on_date:e.getDate(),status:p.status}:"annual"===m&&(t={task_name:p.quest_name,quest_rank:p.quest_rank,frequency:"Annual",status:p.status});t&&await n.post("/recurring",t)}catch(t){}h({quest_name:"",quest_rank:"Common",due_date:"",due_time:"",status:"Pending"}),y("none"),await g()}},children:"Add"})]})]}),(0,$r.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,$r.jsx)("div",{className:"kicker",style:{marginBottom:8},children:"Today"}),(0,$r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[o.filter((e=>e.due_date===ea(d))).slice(0,6).map((e=>(0,$r.jsx)("button",{className:"task-chip",style:{textAlign:"left"},onClick:()=>x(e),children:e.quest_name},e.id))),0===o.filter((e=>e.due_date===ea(d))).length&&(0,$r.jsx)("span",{className:"small",children:"No tasks"})]})]}),(0,$r.jsx)(sa,{open:C,baseDate:new Date(p.due_date||new Date),onClose:()=>N(!1),onSave:e=>{try{const t={task_name:p.quest_name,quest_rank:p.quest_rank,frequency:e.frequency,status:p.status};e.interval&&(t.interval=e.interval),"Weekly"===e.frequency&&e.days&&(t.days=e.days),"Monthly"===e.frequency&&("weekday"===e.monthly_mode?(t.monthly_mode="weekday",t.monthly_week_index=e.monthly_week_index,t.monthly_weekday=e.monthly_weekday):t.monthly_on_date=e.monthly_on_date),e.ends&&(t.ends=e.ends),e.until_date&&(t.until_date=e.until_date),e.count&&(t.count=e.count),y("none"),Yr().post("/recurring",t)}catch(ma){}}})]}),(0,$r.jsxs)("div",{className:"main-pane",children:[(0,$r.jsxs)("div",{className:"row",style:{justifyContent:"space-between",marginBottom:12},children:[(0,$r.jsx)("h2",{children:"Calendar"}),(0,$r.jsx)(Gr,{summary:r})]}),(0,$r.jsx)(oa,{tasks:o,view:s,anchorDate:d,onPrev:()=>{f("week"===s?na(d,-7):"month"===s?new Date(d.getFullYear(),d.getMonth()-1,1):na(d,-1))},onNext:()=>{f("week"===s?na(d,7):"month"===s?new Date(d.getFullYear(),d.getMonth()+1,1):na(d,1))},onToday:()=>f(new Date),onViewChange:u,onOpenTask:x}),(0,$r.jsx)("div",{className:"card list-scroll",style:{marginTop:16},children:(0,$r.jsxs)("table",{className:"table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Quest Name"}),(0,$r.jsx)("th",{children:"Quest Rank"}),(0,$r.jsx)("th",{children:"Due Date"}),(0,$r.jsx)("th",{children:"Status"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:o.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>x(e),style:{border:"none",background:"transparent",color:"#111",padding:0},children:e.quest_name})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("select",{value:e.quest_rank,onChange:t=>b(e.id,{quest_rank:t.target.value}),children:Qr.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))})}),(0,$r.jsxs)("td",{children:[(0,$r.jsx)("span",{className:"dot ".concat(w(e.due_date)),style:{marginRight:6}}),(0,$r.jsx)("input",{type:"date",value:e.due_date,onChange:t=>b(e.id,{due_date:t.target.value})}),e.due_time?(0,$r.jsx)("span",{className:"small",style:{marginLeft:8},children:e.due_time}):null]}),(0,$r.jsx)("td",{children:(0,$r.jsx)("select",{value:e.status,onChange:async t=>{const r=t.target.value;return"Completed"===r?await v(e.id):"Incomplete"===r?await(async e=>{await n.post("/quests/active/".concat(e,"/mark-incomplete")),await g()})(e.id):void await b(e.id,{status:r})},children:Kr.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>v(e.id),children:"Complete"})})]},e.id)))})]})}),(0,$r.jsx)(ia,{open:!!k,task:k,onClose:E,onSave:async e=>{await b(e.id,{quest_name:e.quest_name,due_date:e.due_date,due_time:e.due_time||null}),E()},onDelete:async e=>{await(async e=>{await n.delete("/quests/active/".concat(e)),await g()})(e.id),E()}})]})]})}function ca(){const e=Yr(),[t,n]=(0,a.useState)([]),{summary:r}=Zr();(0,a.useEffect)((()=>{(async()=>{const{data:t}=await e.get("/quests/completed");n(t)})()}),[]);return(0,$r.jsxs)("div",{className:"container",children:[(0,$r.jsxs)("div",{className:"row",style:{justifyContent:"space-between"},children:[(0,$r.jsx)("h2",{children:"Completed Quests"}),(0,$r.jsxs)("div",{className:"badge small",children:["Total earned: ",r.total_earned]})]}),(0,$r.jsx)("div",{className:"card",style:{marginTop:16},children:(0,$r.jsxs)("table",{className:"table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Quest Name"}),(0,$r.jsx)("th",{children:"Quest Rank"}),(0,$r.jsx)("th",{children:"XP Earned"}),(0,$r.jsx)("th",{children:"Date Completed"})]})}),(0,$r.jsx)("tbody",{children:t.map((e=>{return(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.quest_name}),(0,$r.jsx)("td",{children:e.quest_rank}),(0,$r.jsx)("td",{children:e.xp_earned}),(0,$r.jsx)("td",{children:(t=e.date_completed,new Date(t).toLocaleString())})]},e.id);var t}))})]})})]})}function da(){const e=Yr(),{summary:t,refresh:n}=Zr(),[r,l]=(0,a.useState)([]),[o,i]=(0,a.useState)([]),[s,u]=(0,a.useState)([]),[d,f]=(0,a.useState)({reward_name:"",xp_cost:25}),p=async()=>{const[t,n,r]=await Promise.all([e.get("/rewards/store"),e.get("/rewards/log"),e.get("/rewards/inventory")]);l(t.data),i(n.data),u(r.data)};(0,a.useEffect)((()=>{p()}),[]);const h=function(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"redeem";const a=null!==(t=null===e||void 0===e?void 0:e.clientX)&&void 0!==t?t:window.innerWidth/2,l=null!==(n=null===e||void 0===e?void 0:e.clientY)&&void 0!==n?n:window.innerHeight/2,o=document.createElement("div");o.className="reward-anim-container",document.body.appendChild(o);let i=0;const s=()=>{i++,i>=24&&o.remove()};for(let u=0;u<24;u++){const e=document.createElement("span");e.className="reward-confetti";const t=160*(2*Math.random()-1),n=-(40+160*Math.random()),i=(360*Math.random()-180).toFixed(0)+"deg",u=6+6*Math.random();e.style.left=a+"px",e.style.top=l+"px",e.style.width=u+"px",e.style.height=u+"px",e.style.borderRadius=Math.random()>.5?"50%":"2px",e.style.setProperty("--dx",t+"px"),e.style.setProperty("--dy",n+"px"),e.style.setProperty("--rot",i),e.style.setProperty("--bg","use"===r?"#333":"#111"),e.addEventListener("animationend",s,{once:!0}),o.appendChild(e)}setTimeout((()=>{try{o.remove()}catch(e){}}),1200)},m=e=>new Date(e).toLocaleString();return(0,$r.jsxs)("div",{className:"container",children:[(0,$r.jsxs)("div",{className:"row",style:{justifyContent:"space-between"},children:[(0,$r.jsx)("h2",{children:"Rewards"}),(0,$r.jsx)(Gr,{summary:t})]}),(0,$r.jsx)("form",{onSubmit:async t=>{t.preventDefault(),d.reward_name&&d.xp_cost&&(await e.post("/rewards/store",d),f({reward_name:"",xp_cost:25}),await p())},className:"card",style:{marginTop:16},children:(0,$r.jsxs)("div",{className:"row",children:[(0,$r.jsx)("input",{className:"input",placeholder:"Reward name",value:d.reward_name,onChange:e=>f(c(c({},d),{},{reward_name:e.target.value}))}),(0,$r.jsx)("input",{className:"input",type:"number",placeholder:"XP cost",value:d.xp_cost,onChange:e=>f(c(c({},d),{},{xp_cost:Number(e.target.value)}))}),(0,$r.jsx)("button",{className:"btn",type:"submit",children:"Save"})]})}),(0,$r.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,$r.jsx)("h3",{className:"kicker",children:"Reward Store"}),(0,$r.jsxs)("table",{className:"table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Reward"}),(0,$r.jsx)("th",{children:"XP Cost"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:r.map((t=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:t.reward_name}),(0,$r.jsx)("td",{children:t.xp_cost}),(0,$r.jsxs)("td",{style:{display:"flex",gap:8},children:[(0,$r.jsx)("button",{className:"btn",onClick:r=>(async(t,r)=>{try{await e.post("/rewards/redeem",{reward_id:t}),h(r,"redeem"),await Promise.all([p(),n()])}catch(o){var a,l;alert((null===o||void 0===o||null===(a=o.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.detail)||"Unable to redeem")}})(t.id,r),children:"Redeem"}),(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>(async t=>{await e.delete("/rewards/store/".concat(t)),await p()})(t.id),children:"Delete"})]})]},t.id)))})]})]}),(0,$r.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,$r.jsx)("h3",{className:"kicker",children:"My Redeemed Rewards"}),(0,$r.jsxs)("table",{className:"table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Date Redeemed"}),(0,$r.jsx)("th",{children:"Reward"}),(0,$r.jsx)("th",{children:"XP Cost"}),(0,$r.jsx)("th",{children:"Status"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:s.filter((e=>!e.used)).map((t=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:m(t.date_redeemed)}),(0,$r.jsx)("td",{children:t.reward_name}),(0,$r.jsx)("td",{children:t.xp_cost}),(0,$r.jsx)("td",{children:t.used?"Used":"Available"}),(0,$r.jsx)("td",{children:t.used?null:(0,$r.jsx)("button",{className:"btn",onClick:r=>(async(t,r)=>{try{await e.post("/rewards/use/".concat(t)),h(r,"use"),await Promise.all([p(),n()])}catch(o){var a,l;alert((null===o||void 0===o||null===(a=o.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.detail)||"Unable to use reward")}})(t.id,r),children:"Use"})})]},t.id)))})]})]}),(0,$r.jsxs)("div",{className:"card",style:{marginTop:16},children:[(0,$r.jsx)("h3",{className:"kicker",children:"Reward Log"}),(0,$r.jsxs)("table",{className:"table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Date Redeemed"}),(0,$r.jsx)("th",{children:"Reward"}),(0,$r.jsx)("th",{children:"XP Cost"})]})}),(0,$r.jsx)("tbody",{children:o.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:m(e.date_redeemed)}),(0,$r.jsx)("td",{children:e.reward_name}),(0,$r.jsx)("td",{children:e.xp_cost})]},e.id)))})]})]})]})}function fa(){const e=Yr(),[t,n]=(0,a.useState)([]),[r,l]=(0,a.useState)({task_name:"",quest_rank:"Common",frequency:"Daily",days:"",status:"Pending"}),o=async()=>{const{data:t}=await e.get("/recurring");n(t)};(0,a.useEffect)((()=>{o()}),[]);return(0,$r.jsxs)("div",{className:"container",children:[(0,$r.jsxs)("div",{className:"row",style:{justifyContent:"space-between"},children:[(0,$r.jsx)("h2",{children:"Recurring Tasks"}),(0,$r.jsx)("button",{className:"btn",onClick:async()=>{await e.post("/recurring/run")},children:"Generate Today's Quests"})]}),(0,$r.jsx)("form",{onSubmit:async t=>{t.preventDefault(),await e.post("/recurring",r),l({task_name:"",quest_rank:"Common",frequency:"Daily",days:"",status:"Pending"}),await o()},className:"card",style:{marginTop:16},children:(0,$r.jsxs)("div",{className:"row",children:[(0,$r.jsx)("input",{className:"input",placeholder:"Task name",value:r.task_name,onChange:e=>l(c(c({},r),{},{task_name:e.target.value}))}),(0,$r.jsx)("select",{value:r.quest_rank,onChange:e=>l(c(c({},r),{},{quest_rank:e.target.value})),children:Qr.map((e=>(0,$r.jsx)("option",{children:e},e)))}),(0,$r.jsx)("select",{value:r.frequency,onChange:e=>l(c(c({},r),{},{frequency:e.target.value})),children:["Daily","Weekly","Weekdays","Monthly"].map((e=>(0,$r.jsx)("option",{children:e},e)))}),(0,$r.jsx)("input",{className:"input",placeholder:"Days (Mon, Fri) for Weekly",value:r.days,onChange:e=>l(c(c({},r),{},{days:e.target.value}))}),(0,$r.jsx)("select",{value:r.status,onChange:e=>l(c(c({},r),{},{status:e.target.value})),children:["Pending","In Progress","Completed","Incomplete"].map((e=>(0,$r.jsx)("option",{children:e},e)))}),(0,$r.jsx)("button",{className:"btn",type:"submit",children:"Add"})]})}),(0,$r.jsx)("div",{className:"card",style:{marginTop:16},children:(0,$r.jsxs)("table",{className:"table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Task Name"}),(0,$r.jsx)("th",{children:"Quest Rank"}),(0,$r.jsx)("th",{children:"Frequency"}),(0,$r.jsx)("th",{children:"Days"}),(0,$r.jsx)("th",{children:"Status"}),(0,$r.jsx)("th",{children:"Last Added"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:t.map((t=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:t.task_name}),(0,$r.jsx)("td",{children:t.quest_rank}),(0,$r.jsx)("td",{children:t.frequency}),(0,$r.jsx)("td",{children:t.days||"-"}),(0,$r.jsx)("td",{children:t.status}),(0,$r.jsx)("td",{children:t.last_added||"-"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("button",{className:"btn secondary",onClick:()=>(async t=>{await e.delete("/recurring/".concat(t)),await o()})(t.id),children:"Delete"})})]},t.id)))})]})})]})}function pa(){const e=Yr(),[t,n]=(0,a.useState)("");(0,a.useEffect)((()=>{(async()=>{const{data:t}=await e.get("/rules");n((null===t||void 0===t?void 0:t.content)||"")})()}),[]);return(0,$r.jsxs)("div",{className:"container",children:[(0,$r.jsxs)("div",{className:"row",style:{justifyContent:"space-between"},children:[(0,$r.jsx)("h2",{children:"Rules"}),(0,$r.jsx)("button",{className:"btn",onClick:async()=>{await e.put("/rules",{content:t})},children:"Save"})]}),(0,$r.jsx)("div",{className:"card",style:{marginTop:16},children:(0,$r.jsx)("textarea",{rows:10,style:{width:"100%"},value:t,onChange:e=>n(e.target.value)})})]})}const ha=function(){return(0,$r.jsx)("div",{className:"App",children:(0,$r.jsxs)(ft,{children:[(0,$r.jsx)(Xr,{}),(0,$r.jsxs)(Re,{children:[(0,$r.jsx)(Te,{path:"/",element:(0,$r.jsx)(ua,{})}),(0,$r.jsx)(Te,{path:"/completed",element:(0,$r.jsx)(ca,{})}),(0,$r.jsx)(Te,{path:"/rewards",element:(0,$r.jsx)(da,{})}),(0,$r.jsx)(Te,{path:"/recurring",element:(0,$r.jsx)(fa,{})}),(0,$r.jsx)(Te,{path:"/rules",element:(0,$r.jsx)(pa,{})})]})]})})};l.createRoot(document.getElementById("root")).render((0,$r.jsx)(a.StrictMode,{children:(0,$r.jsx)(ha,{})}))})();
//# sourceMappingURL=main.1525620a.js.map